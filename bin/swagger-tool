#!/usr/bin/env node
const yargs = require('yargs')
const path = require('path')
const { version } = require('../package.json')
const { SwaggerTool, ConfigOptions } = require('../dist/main.js')

const argv = yargs
    .usage('Usage: swagger-tool -c [swagger.conf.js] -m [module name] -e [entity name]')
    .help('help').alias('help', 'h')
    .version('version', version).alias('version', 'v')
    .option('module', {
        alias: 'm',
        type: 'string',
        describe: '需要创建或同步的模块',
    })
    .option('entity', {
        alias: 'e',
        type: 'string',
        describe: '需要创建或同步的 API 实体',
    })
    .option('config', {
        alias: 'c',
        default: ConfigOptions.defaultConfigPath,
        type: 'string',
        required: true,
        describe: '脚本配置文件, 详见 README.md'
    })
    .example('swagger-tool', '使用默认配置 并下载 `doc.json` 文件')
    .example('swagger-tool -c conf.js', '使用指定配置文件 并下载 `doc.json` 文件')
    .example('swagger-tool -m User -e commoditys.Commodity', '下载 `doc.json` 文件 并 ')
    .argv

const main = () => {
    const tool = new SwaggerTool(path.join(process.cwd(), argv.config), argv.module, argv.entity)
    console.log(tool)
}

main()